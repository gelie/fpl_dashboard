{% extends 'base.html' %}

{% block content %}
<nav aria-label="breadcrumb">
  <ul>
    <li><a href="/">Dashboard</a></li>
    <li>Players</li>
  </ul>
</nav>

<section>
  <h3>Players Management</h3>

  <!-- Add Player Button (Admin Only) -->
  {% if is_admin %}
  <div class="mb-4">
    <button class="btn btn-primary" onclick="addPlayer()">
      Add New Player
    </button>
  </div>
  {% endif %}

  <!-- Players Table -->
  <div class="table-container">
    <table>
      <thead>
        <tr>
          <!-- <th>ID</th> -->
          <th>Name</th>
          <th>Team</th>
          {% if is_admin %}
          <th>Actions</th>
          {% else %}
          <th>Status</th>
          {% endif %}
        </tr>
      </thead>
      <tbody>
        {% for player in players %}
        <tr>
          <!-- <td>{{ player.id }}</td> -->
          <td>{{ player.name }}</td>
          <td>{{ player.team }}</td>
          <td>
            {% if is_admin %}
            <div class="action-buttons">
              <button class="primary" onclick="editPlayer('{{ player.id }}', '{{ player.name }}', '{{ player.team }}')">
                Edit
              </button><!--
              -->
              <form method="post" action="/players/{{ player.id }}/delete"
                onsubmit="return confirm('Are you sure you want to delete this player?')">
                <button type="submit" class="secondary">
                  Delete
                </button>
              </form>
            </div>
            {% else %}
            <span class="text-muted">View Only</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
        {% if not players %}
        <tr>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</section>

{% include 'player.html' %}

<script>
  function addPlayer() {
    // Reset form for adding new score
    document.getElementById('dialog-title').textContent = 'Add New Player';
    document.getElementById('player-form').action = '/players';
    document.getElementById('submit-button').textContent = 'Add Player';

    // Clear form fields
    // document.getElementById('player_id').value = '';
    document.getElementById('name').value = '';
    document.getElementById('team').value = '';

    // Show modal
    document.getElementById('add-player-dialog').showModal();
  }

  function editPlayer(playerId, name, team) {
    // Set form for editing existing score
    document.getElementById('dialog-title').textContent = 'Edit Player';
    document.getElementById('player-form').action = '/players/' + playerId;
    document.getElementById('submit-button').textContent = 'Update Player';

    // Populate form fields with existing data
    // document.getElementById('player_id').value = playerId;
    document.getElementById('name').value = name;
    document.getElementById('team').value = team;

    // Show modal
    document.getElementById('add-player-dialog').showModal();
  }
</script>
{% endblock %}